<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEWTON OS // TSC GATEWAY</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="scanlines"></div>

    <!-- Boot Glitch -->
    <div id="boot-3" class="full-screen active">
        <div class="boot-center">
            <img src="/obunto/normal.png" class="boot-logo" alt="Obunto Logo">
            <div class="boot-text">OBUNTO SYSTEM LOADING<span id="glitch-dots"></span></div>
        </div>
    </div>

    <!-- Boot Mainframe -->
    <div id="boot-2" class="full-screen" style="display:none;">
        <div class="boot-center">
            <div class="boot-title">TSC MAINFRAME</div>
            <div class="boot-box">
                <div class="boot-line">Verifying TSC signature........OK</div>
                <div class="boot-line">Loading Newton emulation.......OK</div>
                <div class="boot-line">Mounting assets..................<span id="boot-progress">□□□□□□□□□□ 0%</span></div>
                <div class="boot-line"><span id="boot-status">INITIALIZING...</span></div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="full-screen" style="display:none;">
        <div class="boot-center">
            <img src="/assets/icon-large-assist-13x20.png" class="boot-logo" alt="Assist Icon">
            <div class="boot-box">
                <div class="boot-title">TSC NEWTON GATEWAY</div>
                <input id="inpId" type="text" placeholder="ENTER USER ID" class="input-newton">
                <div id="loginStatus" class="status-text"></div>
                <button id="btnLogin" class="btn-newton">AUTHENTICATE</button>
            </div>
        </div>
    </div>

    <!-- Desktop -->
    <div id="desktop-screen" class="full-screen" style="display:none;">
        <!-- Perfil Window -->
        <div id="profile-window" class="window-newton">
            <div class="win-header">
                <img src="/assets/icon-large-names-32x22.png" alt="Names Icon" class="header-icon">
                <span>NAMES</span>
                <img src="/assets/button-close-17x17.png" alt="Close" class="close-btn">
            </div>
            <div class="win-body">
                <img id="userAvatar" src="" class="avatar">
                <div class="data-row"><b>ID:</b> <span id="userId"></span></div>
                <div class="data-row"><b>NAME:</b> <span id="userName"></span></div>
                <div class="data-row"><b>DEPT:</b> <span id="userDept"></span></div>
                <div class="data-row"><b>RANK:</b> <span id="userRank"></span></div>
                <div class="data-row"><b>CLEARANCE:</b> <span id="userClearance"></span></div>
            </div>
        </div>

        <!-- Obunto Bubble -->
        <div id="obunto-bubble" class="obunto-overlay hidden">
            <img id="obunto-img" src="/obunto/normal.png" alt="Obunto">
            <div id="obunto-text" class="speech-bubble"></div>
        </div>

        <!-- Dock -->
        <div class="dock-newton">
            <img src="/assets/icon-large-notes-17x22.png" alt="Notes">
            <img src="/assets/icon-large-dates-25x22.png" alt="Dates">
            <img src="/assets/icon-large-find-21x21.png" alt="Find">
            <img src="/assets/icon-large-setup-25x22.png" alt="Setup">
            <span id="clock">--:--</span>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="renderer.js"></script>
    <script>
        window.addEventListener('load', () => {
            let gdots = 0;
            const glitchInterval = setInterval(() => {
                gdots = (gdots + 1) % 4;
                document.getElementById('glitch-dots').innerText = '.'.repeat(gdots);
            }, 600);

            setTimeout(() => {
                document.getElementById('boot-3').style.display = 'none';
                document.getElementById('boot-2').style.display = 'flex';

                let progress = 0;
                const progInt = setInterval(() => {
                    progress += 10;
                    if (progress > 100) progress = 100;
                    const bars = '■■■■■■■■■■'.slice(0, Math.floor(progress / 10));
                    const empty = '□□□□□□□□□□'.slice(0, 10 - Math.floor(progress / 10));
                    document.getElementById('boot-progress').innerText = `${bars}${empty} ${progress}%`;

                    if (progress >= 100) {
                        clearInterval(progInt);
                        document.getElementById('boot-status').innerText = "COMPLETE";
                        setTimeout(() => {
                            document.getElementById('boot-2').style.display = 'none';
                            document.getElementById('login-screen').style.display = 'flex';
                        }, 1000);
                    }
                }, 200); // Mais rápido para evitar travamento percebido

                // Fallback se progresso falhar
                setTimeout(() => {
                    if (document.getElementById('boot-2').style.display !== 'none') {
                        document.getElementById('boot-2').style.display = 'none';
                        document.getElementById('login-screen').style.display = 'flex';
                    }
                }, 7000);
            }, 3000);
        });
    </script>
</body>
</html>