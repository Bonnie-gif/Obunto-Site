:root {
  /* Newton OS Color Palette - Professional grayscale */
  --bg-main: #d4d4d4;
  --bg-light: #ebebeb;
  --bg-dark: #a0a0a0;
  --ink: #000000;
  --ink-dim: #606060;
  --ink-light: #202020;
  --paper: #ffffff;
  --paper-dark: #f0f0f0;
  --paper-light: #fafafa;
  --border: #000000;
  --border-dark: #505050;
  --border-light: #808080;
  --border-highlight: #ffffff;
  --shadow: rgba(0, 0, 0, 0.3);
  --shadow-dark: rgba(0, 0, 0, 0.6);
  --button: #d4d4d4;
  --button-hover: #e4e4e4;
  --button-active: #b4b4b4;
  --font-main: 'Chicago', 'Espy Sans', 'Geneva', 'System', sans-serif;
  --font-mono: 'Monaco', 'Courier New', 'Courier', monospace;
  --alert-color: #000000;
  --radius: 0px;
}

* { 
  box-sizing: border-box; 
  margin: 0; 
  padding: 0; 
}

html, body {
  height: 100%; 
  margin: 0; 
  background: var(--bg-main);
  font-family: var(--font-main);
  font-size: 12px; 
  color: var(--ink); 
  overflow: hidden;
  image-rendering: pixelated;
  image-rendering: -moz-crisp-edges;
  image-rendering: crisp-edges;
  transition: background 0.2s ease, filter 0.2s ease;
  cursor: default;
  -webkit-font-smoothing: none;
  -moz-osx-font-smoothing: grayscale;
}

/* Subtle Newton OS texture pattern */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: 
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.015) 2px,
      rgba(0, 0, 0, 0.015) 4px
    );
  pointer-events: none;
  z-index: 1;
  opacity: 0.4;
}

.hidden { display: none !important; }
.active { display: flex !important; }

/* ===== ALARM STATES WITH EFFECTS ===== */

/* GREEN - Normal state, no effects */
body.alarm-green {
  --bg-main: #d4d4d4;
  --alert-color: #00aa00;
}

/* BLUE - Normal state, no effects */
body.alarm-blue { 
  --bg-main: #8ab4d4; 
  --bg-light: #a5c5e0;
  --bg-dark: #6a94b4;
  --ink: #001040; 
  --paper: #e5f0fa; 
  --alert-color: #0066dd;
  --button: #a5c5e0;
}

/* RED - Slight shake on windows */
body.alarm-red { 
  --bg-main: #d48a8a; 
  --bg-light: #e0a5a5;
  --bg-dark: #b46a6a;
  --ink: #400000; 
  --paper: #fae5e5; 
  --alert-color: #dd0000;
  --button: #e0a5a5;
}

body.alarm-red .window-newton {
  animation: redShake 3s infinite;
}

@keyframes redShake {
  0%, 100% { transform: translate(0, 0); }
  10% { transform: translate(-1px, 1px); }
  20% { transform: translate(1px, -1px); }
  30% { transform: translate(-1px, -1px); }
  40% { transform: translate(1px, 1px); }
  50% { transform: translate(-1px, 1px); }
  60% { transform: translate(1px, -1px); }
  70% { transform: translate(-1px, -1px); }
  80% { transform: translate(1px, 1px); }
  90% { transform: translate(-1px, 0); }
}

/* GAMMA - More shake, light visual glitches */
body.alarm-gamma { 
  --bg-main: #d4d48a; 
  --bg-light: #e0e0a5;
  --bg-dark: #b4b46a;
  --ink: #404000; 
  --paper: #fafae5; 
  --alert-color: #dddd00;
  --button: #e0e0a5;
}

body.alarm-gamma .window-newton {
  animation: gammaShake 2s infinite, gammaGlitch 5s infinite;
}

@keyframes gammaShake {
  0%, 100% { transform: translate(0, 0); }
  10% { transform: translate(-2px, 2px); }
  20% { transform: translate(2px, -2px); }
  30% { transform: translate(-2px, -2px); }
  40% { transform: translate(2px, 2px); }
  50% { transform: translate(-2px, 2px); }
  60% { transform: translate(2px, -2px); }
  70% { transform: translate(-2px, -2px); }
  80% { transform: translate(2px, 2px); }
  90% { transform: translate(-2px, 0); }
}

@keyframes gammaGlitch {
  0%, 90%, 100% { opacity: 1; filter: none; }
  91% { opacity: 0.8; filter: hue-rotate(10deg); }
  92% { opacity: 1; filter: none; }
  93% { opacity: 0.9; filter: hue-rotate(-10deg); }
  94% { opacity: 1; filter: none; }
}

body.alarm-gamma .viewer {
  animation: gammaTextGlitch 4s infinite;
}

@keyframes gammaTextGlitch {
  0%, 95%, 100% { filter: none; }
  96% { filter: blur(0.5px); }
  97% { filter: none; }
  98% { filter: blur(0.5px); }
}

/* EPSILON - Heavy corruption, black screen, severe glitches and static */
body.alarm-epsilon { 
  --bg-main: #1a1a1a; 
  --bg-light: #2a2a2a;
  --bg-dark: #0a0a0a;
  --ink: #00ff00; 
  --paper: #000000; 
  --alert-color: #ff00ff; 
  --button: #2a2a2a;
  --border: #00ff00;
  --border-dark: #00aa00;
  filter: contrast(150%) brightness(90%);
}

body.alarm-epsilon .window-newton {
  animation: epsilonShake 0.8s infinite, epsilonCorrupt 3s infinite, epsilonStatic 0.1s infinite;
  filter: invert(0.1) hue-rotate(90deg);
}

@keyframes epsilonShake {
  0% { transform: translate(0, 0) rotate(0deg); }
  10% { transform: translate(-4px, 3px) rotate(-1deg); }
  20% { transform: translate(3px, -4px) rotate(1deg); }
  30% { transform: translate(-3px, -3px) rotate(-0.5deg); }
  40% { transform: translate(4px, 4px) rotate(0.5deg); }
  50% { transform: translate(-4px, 2px) rotate(-1deg); }
  60% { transform: translate(3px, -3px) rotate(1deg); }
  70% { transform: translate(-2px, -4px) rotate(-0.5deg); }
  80% { transform: translate(4px, 3px) rotate(0.5deg); }
  90% { transform: translate(-3px, 0) rotate(-1deg); }
  100% { transform: translate(0, 0) rotate(0deg); }
}

@keyframes epsilonCorrupt {
  0%, 70%, 100% { opacity: 1; }
  71% { opacity: 0.3; }
  72% { opacity: 1; }
  73% { opacity: 0.5; }
  74% { opacity: 1; }
  75% { opacity: 0.2; }
  76% { opacity: 1; }
  80% { opacity: 0.4; }
  81% { opacity: 1; }
}

@keyframes epsilonStatic {
  0% { background-position: 0 0; }
  10% { background-position: -5px -5px; }
  20% { background-position: 5px 5px; }
  30% { background-position: -5px 5px; }
  40% { background-position: 5px -5px; }
  50% { background-position: 0 0; }
  60% { background-position: -3px -3px; }
  70% { background-position: 3px 3px; }
  80% { background-position: -3px 3px; }
  90% { background-position: 3px -3px; }
  100% { background-position: 0 0; }
}

body.alarm-epsilon::after {
  content: '';
  position: fixed;
  inset: 0;
  background-image: 
    repeating-linear-gradient(
      0deg,
      transparent 0px,
      rgba(0, 255, 0, 0.03) 1px,
      transparent 2px
    ),
    repeating-linear-gradient(
      90deg,
      transparent 0px,
      rgba(0, 255, 0, 0.03) 1px,
      transparent 2px
    );
  pointer-events: none;
  z-index: 9999;
  animation: epsilonStaticNoise 0.2s infinite;
}

@keyframes epsilonStaticNoise {
  0% { opacity: 0.5; }
  25% { opacity: 0.3; }
  50% { opacity: 0.6; }
  75% { opacity: 0.2; }
  100% { opacity: 0.5; }
}

body.alarm-epsilon .viewer,
body.alarm-epsilon .sidebar,
body.alarm-epsilon .topbar {
  background: #000000;
  color: #00ff00;
  border-color: #00ff00;
  text-shadow: 0 0 5px #00ff00;
}

body.alarm-epsilon .btn-newton,
body.alarm-epsilon .btn-action {
  background: #0a0a0a;
  color: #00ff00;
  border-color: #00ff00;
  text-shadow: 0 0 3px #00ff00;
  animation: epsilonButtonGlitch 2s infinite;
}

@keyframes epsilonButtonGlitch {
  0%, 90%, 100% { filter: none; }
  91% { filter: invert(1); }
  92% { filter: none; }
  95% { filter: invert(1); }
  96% { filter: none; }
}

/* Remove CRT overlay effects for clean Newton look */
.crt-overlay {
  display: none;
}

.scanlines {
  display: none;
}

/* Newton-style selection */
::selection {
  background: #000000;
  color: #ffffff;
}

::-moz-selection {
  background: #000000;
  color: #ffffff;
}